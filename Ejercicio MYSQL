CREATE DATABASE EVALUACION;
USE EVALUACION;

CREATE TABLE TABLA(
	ID INT AUTO_INCREMENT PRIMARY KEY,
    NOMBRE VARCHAR(10) CONSTRAINT CHK_NOMBRE CHECK (CHAR_LENGTH(NOMBRE)>=5) NOT NULL,
    APELLIDO VARCHAR(10) CONSTRAINT CHK_APELLIDO CHECK (APELLIDO NOT LIKE '%S%S%S%'),
    ALTURA DECIMAL(3,2) NOT NULL,
    EDAD INT CONSTRAINT CHK_EDAD CHECK (EDAD >=18 AND EDAD <=63),
    DIRECCION VARCHAR(50) CONSTRAINT CHK_DIRECCION 
    CHECK ((DIRECCION LIKE 'CALLE' OR DIRECCION LIKE 'AVENIDA') 
    AND (DIRECCION LIKE 'Nº' AND DIRECCION LIKE 'BLOQUE') AND CHAR_LENGTH(DIRECCION)>=10) NOT NULL,
    GENERO ENUM ('MASCULINO', 'FEMENINO', 'OTROS') DEFAULT 'OTROS',
    FECHA DATE CONSTRAINT CHK_FECHA CHECK (FECHA NOT LIKE '%-06-%' AND FECHA NOT LIKE '%-07-%' 
    AND FECHA NOT LIKE '%-08-%' AND FECHA NOT LIKE '%-09-%') NOT NULL,
    EMAIL VARCHAR(50) CONSTRAINT CHK_EMAIL CHECK (EMAIL LIKE '%@%' AND (EMAIL LIKE '%HOTMAIL%' OR EMAIL LIKE '%GMAIL%'))
)AUTO_INCREMENT=50;

/*MODIFICA EL NOMBRE DE LA TABLA*/
RENAME TABLE TABLA TO PRUEBA;

/*MODIFICA DEL NOMBRE DE LA COLUMNA EMAIL A CORREO*/
ALTER TABLE PRUEBA DROP CONSTRAINT CHK_EMAIL;
ALTER TABLE PRUEBA RENAME COLUMN EMAIL TO CORREO;
ALTER TABLE PRUEBA ADD CONSTRAINT CHK_CORREO CHECK (CORREO LIKE '%@%' AND (CORREO LIKE '%HOTMAIL%' OR CORREO LIKE '%GMAIL%'));

/*MODIFICA LA RESTRICCION DE LA FECHA PARA QUE PERMITA VALORES DE FECHA CONTENIDOS EN VERANO E INVIERNO*/
ALTER TABLE PRUEBA DROP CONSTRAINT CHK_FECHA;
ALTER TABLE PRUEBA ADD CONSTRAINT CHK_FECHA CHECK(FECHA LIKE '%-06-%' OR FECHA LIKE '%-07-%' 
OR FECHA LIKE '%-08-%' OR FECHA LIKE '%-09-%' OR FECHA LIKE '%-12-%' OR FECHA LIKE '%-01-%' 
OR FECHA LIKE '%-02-%' OR FECHA LIKE '%-03-%');

/*MODIFICA EL ATRIBUTO ALTURA PARA QUE PERMITA DOS ENTEROS CON DOS DECIMALES*/
ALTER TABLE PRUEBA MODIFY COLUMN ALTURA DECIMAL(4,2);

/*MODIFICA EL ATRIBUTO APELLIDO PARA QUE AÑADA UN VALOR POR DEFECTO*/
ALTER TABLE PRUEBA DROP CONSTRAINT CHK_APELLIDO;
ALTER TABLE PRUEBA MODIFY COLUMN APELLIDO VARCHAR(10) DEFAULT 'ALVAREZ';
ALTER TABLE PRUEBA ADD CONSTRAINT CHK_APELLIDO CHECK (APELLIDO NOT LIKE '%S%S%S%');

/*AÑADE EL CARACTER M EN EN CONTENIDO DE LA ALTURA*/
ALTER TABLE PRUEBA MODIFY COLUMN ALTURA VARCHAR(5);
UPDATE PRUEBA SET ALTURA=CONCAT(ALTURA, 'M');

/*MODIFICA EL ATRIBUTO EDAD PARA QUE PERMITA VALORES MAYORES DE 65*/
ALTER TABLE PRUEBA DROP CONSTRAINT CHK_EDAD;
ALTER TABLE PRUEBA ADD CONSTRAINT CHK_EDAD CHECK((EDAD >=18 AND EDAD <=63) OR EDAD>65);

/*MODIFICA EL VALOR DE GENERO PARA QUE APAREZCA FEMENINO POR DEFECTO*/
ALTER TABLE PRUEBA MODIFY COLUMN GENERO ENUM ('MASCULINO', 'FEMENINO', 'OTROS') DEFAULT 'FEMENINO';

/*ELIMINA TODOS LOS REGISTROS QUE CONTENGAN HOTMAIL*/
DELETE FROM PRUEBA WHERE CORREO LIKE '%HOTMAIL%';

/*ELIMINA TODOS LOS REGISTROS QUE CONTENGAN MASCULINO*/
DELETE FROM PRUEBA WHERE GENERO LIKE 'MASCULINO';

/*ELIMINA LA COLUMNA ID*/
ALTER TABLE PRUEBA DROP COLUMN ID;

/*ELIMINA LA TABLA DEL EJERCICIO 1*/
DROP TABLE PRUEBA;
